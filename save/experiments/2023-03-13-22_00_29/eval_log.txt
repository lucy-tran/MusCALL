Loading dataset
Number of training samples: 632
Building model
logit_scale True
audio_backbone.conv1.weight True
audio_backbone.bn1.weight True
audio_backbone.bn1.bias True
audio_backbone.conv2.weight True
audio_backbone.bn2.weight True
audio_backbone.bn2.bias True
audio_backbone.conv3.weight True
audio_backbone.bn3.weight True
audio_backbone.bn3.bias True
audio_backbone.layer1.0.conv1.weight True
audio_backbone.layer1.0.bn1.weight True
audio_backbone.layer1.0.bn1.bias True
audio_backbone.layer1.0.conv2.weight True
audio_backbone.layer1.0.bn2.weight True
audio_backbone.layer1.0.bn2.bias True
audio_backbone.layer1.0.conv3.weight True
audio_backbone.layer1.0.bn3.weight True
audio_backbone.layer1.0.bn3.bias True
audio_backbone.layer1.0.downsample.0.weight True
audio_backbone.layer1.0.downsample.1.weight True
audio_backbone.layer1.0.downsample.1.bias True
audio_backbone.layer1.1.conv1.weight True
audio_backbone.layer1.1.bn1.weight True
audio_backbone.layer1.1.bn1.bias True
audio_backbone.layer1.1.conv2.weight True
audio_backbone.layer1.1.bn2.weight True
audio_backbone.layer1.1.bn2.bias True
audio_backbone.layer1.1.conv3.weight True
audio_backbone.layer1.1.bn3.weight True
audio_backbone.layer1.1.bn3.bias True
audio_backbone.layer1.2.conv1.weight True
audio_backbone.layer1.2.bn1.weight True
audio_backbone.layer1.2.bn1.bias True
audio_backbone.layer1.2.conv2.weight True
audio_backbone.layer1.2.bn2.weight True
audio_backbone.layer1.2.bn2.bias True
audio_backbone.layer1.2.conv3.weight True
audio_backbone.layer1.2.bn3.weight True
audio_backbone.layer1.2.bn3.bias True
audio_backbone.layer2.0.conv1.weight True
audio_backbone.layer2.0.bn1.weight True
audio_backbone.layer2.0.bn1.bias True
audio_backbone.layer2.0.conv2.weight True
audio_backbone.layer2.0.bn2.weight True
audio_backbone.layer2.0.bn2.bias True
audio_backbone.layer2.0.conv3.weight True
audio_backbone.layer2.0.bn3.weight True
audio_backbone.layer2.0.bn3.bias True
audio_backbone.layer2.0.downsample.0.weight True
audio_backbone.layer2.0.downsample.1.weight True
audio_backbone.layer2.0.downsample.1.bias True
audio_backbone.layer2.1.conv1.weight True
audio_backbone.layer2.1.bn1.weight True
audio_backbone.layer2.1.bn1.bias True
audio_backbone.layer2.1.conv2.weight True
audio_backbone.layer2.1.bn2.weight True
audio_backbone.layer2.1.bn2.bias True
audio_backbone.layer2.1.conv3.weight True
audio_backbone.layer2.1.bn3.weight True
audio_backbone.layer2.1.bn3.bias True
audio_backbone.layer2.2.conv1.weight True
audio_backbone.layer2.2.bn1.weight True
audio_backbone.layer2.2.bn1.bias True
audio_backbone.layer2.2.conv2.weight True
audio_backbone.layer2.2.bn2.weight True
audio_backbone.layer2.2.bn2.bias True
audio_backbone.layer2.2.conv3.weight True
audio_backbone.layer2.2.bn3.weight True
audio_backbone.layer2.2.bn3.bias True
audio_backbone.layer2.3.conv1.weight True
audio_backbone.layer2.3.bn1.weight True
audio_backbone.layer2.3.bn1.bias True
audio_backbone.layer2.3.conv2.weight True
audio_backbone.layer2.3.bn2.weight True
audio_backbone.layer2.3.bn2.bias True
audio_backbone.layer2.3.conv3.weight True
audio_backbone.layer2.3.bn3.weight True
audio_backbone.layer2.3.bn3.bias True
audio_backbone.layer3.0.conv1.weight True
audio_backbone.layer3.0.bn1.weight True
audio_backbone.layer3.0.bn1.bias True
audio_backbone.layer3.0.conv2.weight True
audio_backbone.layer3.0.bn2.weight True
audio_backbone.layer3.0.bn2.bias True
audio_backbone.layer3.0.conv3.weight True
audio_backbone.layer3.0.bn3.weight True
audio_backbone.layer3.0.bn3.bias True
audio_backbone.layer3.0.downsample.0.weight True
audio_backbone.layer3.0.downsample.1.weight True
audio_backbone.layer3.0.downsample.1.bias True
audio_backbone.layer3.1.conv1.weight True
audio_backbone.layer3.1.bn1.weight True
audio_backbone.layer3.1.bn1.bias True
audio_backbone.layer3.1.conv2.weight True
audio_backbone.layer3.1.bn2.weight True
audio_backbone.layer3.1.bn2.bias True
audio_backbone.layer3.1.conv3.weight True
audio_backbone.layer3.1.bn3.weight True
audio_backbone.layer3.1.bn3.bias True
audio_backbone.layer3.2.conv1.weight True
audio_backbone.layer3.2.bn1.weight True
audio_backbone.layer3.2.bn1.bias True
audio_backbone.layer3.2.conv2.weight True
audio_backbone.layer3.2.bn2.weight True
audio_backbone.layer3.2.bn2.bias True
audio_backbone.layer3.2.conv3.weight True
audio_backbone.layer3.2.bn3.weight True
audio_backbone.layer3.2.bn3.bias True
audio_backbone.layer3.3.conv1.weight True
audio_backbone.layer3.3.bn1.weight True
audio_backbone.layer3.3.bn1.bias True
audio_backbone.layer3.3.conv2.weight True
audio_backbone.layer3.3.bn2.weight True
audio_backbone.layer3.3.bn2.bias True
audio_backbone.layer3.3.conv3.weight True
audio_backbone.layer3.3.bn3.weight True
audio_backbone.layer3.3.bn3.bias True
audio_backbone.layer3.4.conv1.weight True
audio_backbone.layer3.4.bn1.weight True
audio_backbone.layer3.4.bn1.bias True
audio_backbone.layer3.4.conv2.weight True
audio_backbone.layer3.4.bn2.weight True
audio_backbone.layer3.4.bn2.bias True
audio_backbone.layer3.4.conv3.weight True
audio_backbone.layer3.4.bn3.weight True
audio_backbone.layer3.4.bn3.bias True
audio_backbone.layer3.5.conv1.weight True
audio_backbone.layer3.5.bn1.weight True
audio_backbone.layer3.5.bn1.bias True
audio_backbone.layer3.5.conv2.weight True
audio_backbone.layer3.5.bn2.weight True
audio_backbone.layer3.5.bn2.bias True
audio_backbone.layer3.5.conv3.weight True
audio_backbone.layer3.5.bn3.weight True
audio_backbone.layer3.5.bn3.bias True
audio_backbone.layer4.0.conv1.weight True
audio_backbone.layer4.0.bn1.weight True
audio_backbone.layer4.0.bn1.bias True
audio_backbone.layer4.0.conv2.weight True
audio_backbone.layer4.0.bn2.weight True
audio_backbone.layer4.0.bn2.bias True
audio_backbone.layer4.0.conv3.weight True
audio_backbone.layer4.0.bn3.weight True
audio_backbone.layer4.0.bn3.bias True
audio_backbone.layer4.0.downsample.0.weight True
audio_backbone.layer4.0.downsample.1.weight True
audio_backbone.layer4.0.downsample.1.bias True
audio_backbone.layer4.1.conv1.weight True
audio_backbone.layer4.1.bn1.weight True
audio_backbone.layer4.1.bn1.bias True
audio_backbone.layer4.1.conv2.weight True
audio_backbone.layer4.1.bn2.weight True
audio_backbone.layer4.1.bn2.bias True
audio_backbone.layer4.1.conv3.weight True
audio_backbone.layer4.1.bn3.weight True
audio_backbone.layer4.1.bn3.bias True
audio_backbone.layer4.2.conv1.weight True
audio_backbone.layer4.2.bn1.weight True
audio_backbone.layer4.2.bn1.bias True
audio_backbone.layer4.2.conv2.weight True
audio_backbone.layer4.2.bn2.weight True
audio_backbone.layer4.2.bn2.bias True
audio_backbone.layer4.2.conv3.weight True
audio_backbone.layer4.2.bn3.weight True
audio_backbone.layer4.2.bn3.bias True
audio_backbone.attnpool.positional_embedding True
audio_backbone.attnpool.k_proj.weight True
audio_backbone.attnpool.k_proj.bias True
audio_backbone.attnpool.q_proj.weight True
audio_backbone.attnpool.q_proj.bias True
audio_backbone.attnpool.v_proj.weight True
audio_backbone.attnpool.v_proj.bias True
audio_backbone.attnpool.c_proj.weight True
audio_backbone.attnpool.c_proj.bias True
textual_head.token_embedding.weight True
textual_head.position_embedding.weight True
textual_head.transformer.layers.0.0.norm.weight True
textual_head.transformer.layers.0.0.norm.bias True
textual_head.transformer.layers.0.0.fn.to_qkv.weight True
textual_head.transformer.layers.0.0.fn.out_projection.weight True
textual_head.transformer.layers.0.0.fn.out_projection.bias True
textual_head.transformer.layers.0.1.norm.weight True
textual_head.transformer.layers.0.1.norm.bias True
textual_head.transformer.layers.0.1.fn.mlp.0.weight True
textual_head.transformer.layers.0.1.fn.mlp.0.bias True
textual_head.transformer.layers.0.1.fn.mlp.3.weight True
textual_head.transformer.layers.0.1.fn.mlp.3.bias True
textual_head.transformer.layers.1.0.norm.weight True
textual_head.transformer.layers.1.0.norm.bias True
textual_head.transformer.layers.1.0.fn.to_qkv.weight True
textual_head.transformer.layers.1.0.fn.out_projection.weight True
textual_head.transformer.layers.1.0.fn.out_projection.bias True
textual_head.transformer.layers.1.1.norm.weight True
textual_head.transformer.layers.1.1.norm.bias True
textual_head.transformer.layers.1.1.fn.mlp.0.weight True
textual_head.transformer.layers.1.1.fn.mlp.0.bias True
textual_head.transformer.layers.1.1.fn.mlp.3.weight True
textual_head.transformer.layers.1.1.fn.mlp.3.bias True
textual_head.transformer.layers.2.0.norm.weight True
textual_head.transformer.layers.2.0.norm.bias True
textual_head.transformer.layers.2.0.fn.to_qkv.weight True
textual_head.transformer.layers.2.0.fn.out_projection.weight True
textual_head.transformer.layers.2.0.fn.out_projection.bias True
textual_head.transformer.layers.2.1.norm.weight True
textual_head.transformer.layers.2.1.norm.bias True
textual_head.transformer.layers.2.1.fn.mlp.0.weight True
textual_head.transformer.layers.2.1.fn.mlp.0.bias True
textual_head.transformer.layers.2.1.fn.mlp.3.weight True
textual_head.transformer.layers.2.1.fn.mlp.3.bias True
textual_head.transformer.layers.3.0.norm.weight True
textual_head.transformer.layers.3.0.norm.bias True
textual_head.transformer.layers.3.0.fn.to_qkv.weight True
textual_head.transformer.layers.3.0.fn.out_projection.weight True
textual_head.transformer.layers.3.0.fn.out_projection.bias True
textual_head.transformer.layers.3.1.norm.weight True
textual_head.transformer.layers.3.1.norm.bias True
textual_head.transformer.layers.3.1.fn.mlp.0.weight True
textual_head.transformer.layers.3.1.fn.mlp.0.bias True
textual_head.transformer.layers.3.1.fn.mlp.3.weight True
textual_head.transformer.layers.3.1.fn.mlp.3.bias True
textual_head.transformer.norm_out.weight True
textual_head.transformer.norm_out.bias True
textual_head.ln_final.weight True
textual_head.ln_final.bias True
audio_projection.weight True
text_projection.weight True
Building optimizer
# of trainable parameters: 40774153
Started training experiment with id 2023-03-13-22_00_29
batch #:  0
samples:  10
batch #:  1
samples:  10
batch #:  2
samples:  10
batch #:  3
samples:  10
batch #:  4
samples:  10
batch #:  5
samples:  10
batch #:  6
samples:  10
batch #:  7
samples:  10
batch #:  8
samples:  10
batch #:  9
samples:  10
batch #:  10
samples:  3
score_matrix tensor([[-2.1586e-02, -1.1686e-02,  1.1274e-02,  ...,  8.4438e-02,
         -3.4206e-02,  1.2756e-02],
        [ 2.2850e-02,  1.9297e-02,  2.3952e-02,  ..., -7.3626e-03,
          1.8982e-02,  5.6018e-03],
        [ 4.7869e-02,  5.2643e-02,  3.1969e-02,  ..., -1.3709e-02,
          6.0919e-02,  1.3939e-02],
        ...,
        [ 3.4302e-02,  2.9465e-02,  1.0213e-02,  ..., -1.2260e-02,
          4.6795e-02, -6.8836e-03],
        [ 1.2175e-02,  2.1980e-02,  3.6392e-02,  ...,  6.6201e-02,
          2.3015e-03,  2.8463e-02],
        [ 1.9750e-02,  1.5357e-02,  2.1346e-02,  ..., -7.3513e-05,
          1.5360e-02,  5.8581e-03]])
scores_sorted tensor([[ 0.1468,  0.1109,  0.1086,  ..., -0.0381, -0.0387, -0.0429],
        [ 0.0255,  0.0251,  0.0247,  ..., -0.0436, -0.0461, -0.0659],
        [ 0.0691,  0.0684,  0.0671,  ..., -0.0849, -0.0911, -0.1184],
        ...,
        [ 0.0528,  0.0520,  0.0495,  ..., -0.0413, -0.0420, -0.0870],
        [ 0.0982,  0.0814,  0.0753,  ..., -0.0034, -0.0035, -0.0038],
        [ 0.0258,  0.0253,  0.0245,  ..., -0.0270, -0.0310, -0.0458]])
retrieved_indices:  tensor([[19, 35,  4,  ..., 65,  3, 14],
        [58, 12, 99,  ..., 82, 19, 35],
        [65,  7, 76,  ..., 19, 75, 35],
        ...,
        [47, 81, 14,  ..., 19, 75, 35],
        [19,  4, 73,  ..., 14, 52, 30],
        [12, 84, 10,  ..., 82, 19, 35]])
Epoch 1, train loss 2.28905, val loss 2.20322, metric 19.4175, epoch-time 439.301s, lr 4.87764e-05, time-stamp 2023-03-13 22:07:50
Saving best model so far
batch #:  0
samples:  10
batch #:  1
samples:  10
batch #:  2
samples:  10
batch #:  3
samples:  10
batch #:  4
samples:  10
batch #:  5
samples:  10
batch #:  6
samples:  10
batch #:  7
samples:  10
batch #:  8
samples:  10
batch #:  9
samples:  10
batch #:  10
samples:  3
score_matrix tensor([[ 0.0693,  0.0652,  0.0480,  ...,  0.0803,  0.0584,  0.0587],
        [ 0.0772,  0.0712,  0.0623,  ...,  0.0784,  0.0384,  0.0570],
        [ 0.0754,  0.0646,  0.0521,  ...,  0.0751,  0.0314,  0.0692],
        ...,
        [ 0.0911,  0.0778,  0.0682,  ...,  0.0991,  0.0599,  0.0513],
        [ 0.0700,  0.0616,  0.0443,  ...,  0.0680,  0.0330,  0.0849],
        [-0.1307, -0.0411, -0.0261,  ..., -0.0745,  0.0644,  0.0111]])
scores_sorted tensor([[ 9.6853e-02,  9.4888e-02,  9.4059e-02,  ...,  1.5731e-02,
          1.5519e-02,  1.5655e-03],
        [ 1.1024e-01,  9.0420e-02,  9.0169e-02,  ...,  6.9375e-03,
          5.5730e-03, -3.4975e-03],
        [ 1.2354e-01,  1.0821e-01,  1.0195e-01,  ..., -4.4199e-03,
         -6.5573e-03, -1.2180e-02],
        ...,
        [ 1.0642e-01,  1.0019e-01,  9.9456e-02,  ...,  9.9437e-03,
          1.7038e-04, -1.3967e-02],
        [ 1.3452e-01,  1.3253e-01,  1.3115e-01,  ...,  5.7493e-03,
          5.0371e-03,  4.8095e-03],
        [ 2.6145e-01,  2.1028e-01,  1.8292e-01,  ..., -1.3520e-01,
         -1.3708e-01, -1.5259e-01]])
retrieved_indices:  tensor([[43, 17, 23,  ..., 68, 36,  7],
        [99,  4, 20,  ..., 12, 76, 78],
        [99, 20, 59,  ..., 12, 76, 78],
        ...,
        [23, 27, 53,  ..., 59, 36,  7],
        [99, 20, 59,  ..., 76, 78, 12],
        [78, 12, 18,  ..., 23, 27, 38]])
Epoch 2, train loss 2.21087, val loss 2.15628, metric 23.301, epoch-time 471.939s, lr 4.52254e-05, time-stamp 2023-03-13 22:15:44
Saving best model so far